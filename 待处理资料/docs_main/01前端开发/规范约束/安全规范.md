### XSS 攻击

**核心：**恶意脚本注入

**描述：**攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。利用这些恶意脚本，攻击者可获取用户的敏感信息如 Cookie、SessionID 等，进而危害数据安全。

**防御方法：**

1、输入输出检查：一般是对输入格式的检查，例如：邮箱，电话号码，用户名，密码等，按照规定的格式输入

2、富文本类使用标签白名单

3、增加验证码，防止脚本冒充用户提交危险操作

4、通过 CSP，输入长度匹配，接口安全措施等方法

- 禁止加载外域代码，防止复杂的攻击逻辑
- 禁止外域提交，网站被攻击后，用户的数据不会泄露到外域
- 禁止内联脚本执行
- 禁止未授权的脚本执行
- 合理使用上报可以及时发现 XSS，利于尽快修复问题

5、主动监测发现

6、httpOnly: 在 cookie 中设置 HttpOnly 属性后，js 脚本将无法读取到 cookie

### CSRF 攻击

**核心：**利用用户身份伪造请求

**描述：**利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，冒充用户对被攻击的网站发送执行某项操作的请求

**防范方法：**

1、验证码：强制用户必须与应用进行交互，才能完成最终请求。此种方式能很好的遏制 csrf，但是用户体验比较差。

2、尽量使用 post，限制 get 使用

3、同源检测：如何判断请求是否来自外域？HTTP 协议中，每一个异步请求都会携带两个 Header，用于标记来源域名：Origin Header、Referer Header，这两个 Header 在浏览器发起请求时，大多数情况会自动带上，并且不能由前端自定义内容。服务器可以通过解析这两个 Header 中的域名，确定请求的来源域。

4、Samesite Cookie：Set-Cookie 响应头新增 Samesite 属性，用来标明这个 Cookie 是个“同站 Cookie”，同站 Cookie 只能作为第一方 Cookie，不能作为第三方 Cookie，Samesite 有两个属性值，分别是 Strict 和 Lax：

- Samesite=Strict：严格模式，表明这个 Cookie 在任何情况下都不可能作为第三方 Cookie，绝无例外
- Samesite=Lax：宽松模式

5、token：整体思路如下

- 后端随机产生一个 token，把这个 token 保存到 session 状态中；同时后端把这个 token 交给前端页面；
- 前端提交请求时，把 token 加入到请求数据或者头信息中，一起传给后端
- 后端验证前端传来的 token 和 session 是否一致，一致则合法，否则就是非法请求

6、双重 Cookie 验证：用户访问网站页面时，向请求域名注入一个 Cookie，前端向后端发起请求时，取出 Cookie，添加到 URL 的参数中，后端接口验证 Cookie 中的字段与 URL 参数中的字段是否一致，不一致则拒绝。

### HTTP 劫持

核心：广告、弹框 html 注入

描述：在运营商的路由器节点上，设置协议检测，一旦发现是 HTTP 请求，而且是 html 类型请求，则拦截处理。后续做法往往分为 2 种，1 种是类似 DNS 劫持返回 302 让用户浏览器跳转到另外的地址，还有 1 种是在服务器返回的 HTML 数据中插入 js 或 dom 节点（广告）。

### 界面操作劫持/Clickjacking(点击劫持)

核心：视觉欺骗

描述：利用透明的按钮或连接做成陷阱，覆盖在Web界面之上。然后诱使用户在不知情的情况下，点击那个连接访问内容的一种攻击手段。这种行为又称为界面伪装(UI Redressing)。

### 错误的内容推断

核心：js 伪装成图片文件

描述：攻击者将含有 JavaScript 的脚本文件伪装成图片文件（修改后缀等）。该文件逃过了文件类型校验，在服务器里存储了下来。接下来，受害者在访问这段评论的时候，浏览器请求这个伪装成图片的 JavaScript 脚本并执行

### 不安全的第三方依赖包

核心：第三方漏洞

描述：框架及第三方依赖的安全漏洞

### HTTPS 降级 HTTP

核心：拦截首次 http 通信

描述：问题的本质在于浏览器发出去第一次请求就被攻击者拦截了下来并做了修改，根本不给浏览器和服务器进行 HTTPS 通信的机会。大致过程如下，用户在浏览器里输入 URL 的时候往往不是从"https://"开始的，而是直接从域名开始输入，随后浏览器向服务器发起 HTTP 通信，然而由于攻击者的存在，它把服务器端返回的跳转到 HTTPS 页面的响应拦截了，并且代替客户端和服务器端进行后续的通信

### 本地存储数据泄露

核心：敏感、机密数据

描述：前端存储敏感、机密信息易被泄露

### 缺失静态资源完整性校验

核心：CDN 资源劫持

描述：存储在 CDN 中的静态资源，攻击者劫持了 CDN，或者对 CDN 中的资源进行了污染

### 文件上传漏洞

核心：文件类型限制

描述：文件后缀及文件内容没有严格限制

### 文件下载漏洞

核心：文件类型、目录限制

描述：下载敏感文件、下载目录

### ddos攻击

ddos攻击在短时间内发起大量的请求，耗尽服务器的资源，无法响应正常的访问，造成网站实质性下线。
DDOS 不是一种攻击，而是一大类攻击的总称。其中，比较常见的一种攻击是 cc 攻击。cc攻击就是简单粗暴地送来大量正常的请求，超出服务器的最大承受量，导致宕机。

防范方法：

- 备份网站
- HTTP请求的拦截（如果恶意请求有特征，直接拦截）
- 带宽扩容
- CDN


### 通用防范方法

![1](./assets/%E9%98%B2%E8%8C%83%E6%96%B9%E6%B3%95.awebp)

